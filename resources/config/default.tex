\makeatletter
\providecommand{\IfPackageLoaded}[2]{\@ifpackageloaded{#1}{#2}{}}
\providecommand{\IfPackageNotLoaded}[2]{\@ifpackageloaded{#1}{}{#2}}
\providecommand{\IfElsePackageLoaded}[3]{\@ifpackageloaded{#1}{#2}{#3}}
\makeatother

\IfPackageNotLoaded{CJKutf8}{\usepackage[utf8x]{inputenc}} % File encoding: Normal UTF8
\usepackage{cmap}                     % Support copy and search
\usepackage[tracking=true,            % Fonts: hyphenatable letterspacing
expansion=true,                       % Fonts: better grey value
protrusion=true]{microtype}           % Fonts: margin kerning
\usepackage[T1]{fontenc}              % Font encoding: T1
\usepackage{textcomp}                 % For the Euro sign
\usepackage{booktabs}                 % Nice tables
\usepackage{listings}                 % Nice listings
\usepackage{url}                      % Create URLs in the document
\usepackage{color}                    % To use and define colors
\definecolor{LinkColor}{rgb}          % Link color
{0.31,0.46,.64}                       %
\definecolor{MarginColor}{rgb}        % Margin color
{0.31,0.46,.64}                       %
\usepackage[pdftex]{graphicx}         % Include images in PDFs
\usepackage[pdftex,                   % Hyperlinks in PDFs
raiselinks=true,			          % calculate real height of the link
breaklinks,                           % break links
backref=page,                         % backlinks in bibliography (section, slide, page, none)
pagebackref=true,                     % backlinks in bibliography
hyperindex=true,                      % backlinkex index
linktocpage=true,                     % ToC links pages
bookmarks=true,                       % Bookmarks for PDF viewers
bookmarksopen=true,                   % Open bookmarks
bookmarksopenlevel=1,                 % How many levels to open
bookmarksnumbered=true,               % Numbers in the bookmarks
bookmarkstype=toc,                    % Type of bookmark
plainpages=false,                     % Anchors even on plain pages?
pageanchor=true,                      % Pages are linkable
pdfstartview=FitH,                    % Open document with Fit Width
pdfpagelabels=true,                   % set PDF page labels
pdfpagemode=UseOutlines,              % Show bookmarks in viewer
colorlinks,                           % Show colored links
linkcolor=LinkColor,                  % Link color
urlcolor=LinkColor,                   % URL color
anchorcolor=LinkColor,                % Anchor color
citecolor=LinkColor,                  % Cite color
menucolor=LinkColor,                  % Menu color
hypertexnames=true                    % Whatever ;)
]{hyperref}                           % Use hyperlinks
\renewcommand*{\backref}[1]{[cited at page #1]}% Show formatted backlinks
\usepackage{marginnote}               % Non floating margin notes
\usepackage[caption=false]{subfig}    % Many figures in one environment
\usepackage{stfloats}                 % Makes LaTeX honour ‘[b]’ placement
\usepackage{amssymb}                  % Springer Verlag
\usepackage{amsmath}                  % For eqref
\usepackage{acronym}                  % For acronyms
\usepackage{paralist}                 % For inline lists
\usepackage{fixltx2e}                 % Provides fixes for LaTeX
\usepackage{fix-cm}                   % Provides fixes for LaTeX
\usepackage{rotating}                 % e.g. for the special side margin notes
\usepackage{lipsum}                   % To add some dummy text
\usepackage{xspace}                   % Fixing some spacing issues
\usepackage{ellipsis}                 % Puts space around ellipses
\usepackage{ragged2e}                 % New commands/env. for setting ragged text
\usepackage[bf]{caption}[2008/08/24]  % Bold caption (better contrast)
\newcommand{\etc}{etc.\@\xspace}      % Fixing some spacing issues
\lstset{columns=fullflexible}         % Listings in multicolumn mode

\hyphenation{op-tical net-works semi-conduc-tor con-cept}

\renewcommand{\figurename}{Fig.}
\renewcommand{\tablename}{Tab.}
\newcommand{\sectionname}{Sec.}
\newcommand{\equationname}{Eq.}

\makeindex

\setcounter{tocdepth}{3}
\newcommand{\mykeywords}[1]{\par\addvspace\baselineskip
\keywordname\enspace\ignorespaces#1}
\makeatletter
\providecommand*{\toclevel@title}{99}
\providecommand*{\toclevel@author}{99}

\setlength{\marginparwidth}{0.7in}
\newcommand\note[1]{%
  \marginnote{%
    \scriptsize%
    \raggedright%
    \hspace{0pt}%
    \color{MarginColor}%
    %\begin{turn}{270}\emph{#1}\end{turn}
    \emph{#1}
  }
}

\newcommand{\annot}[2][]{%
  \pdfannot width \linewidth height 2\baselineskip depth 0pt{%
    /Subtype/Text%
    /Open false
    /Name /Comment%
    /CA .4%
    /C [.3 .6 .9]%
    /T (\pdfescapestring{#1})%
    /Contents(\pdfescapestring{\detokenize{#2}})%
  }
}
